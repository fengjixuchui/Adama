### LOLBins Calling the Internets

So I like this idea: LOLBins calling a remote Internet destination IP address. LOLBins are something of a problem in detection because they are normal system programs and alerting on their executions tends to produce a flood of false positive alerts and noise. Filtering alerts by user or host is useful but requires analysts to underake extensive tuning that is site-specific and not readily portable from one customer to another. This technique of doing behavioral detection on the LOLbins by looking for remote network connections seems promising.

| Name                                          | Categories                            | Tactics                        | Search                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------|---------------------------------------|--------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Windows Background Intelligent Transfer Service (BITS) Connecting to the Internet           | Defense Evasion, Persistence          | T1197 / BITS Jobs              | process.name:bitsadmin.exe and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                 |
|Windows Certutil Connecting to the Internet           | Command And Control, Lateral Movement | T1105 / Remote File Copy       | process.name:certutil.exe and event.action:"Network connection detected (rule: NetworkConnect)"  and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                  |
|Windows Command Prompt Connecting to the Internet     | Execution                             | T1059 / Command-Line Interface | process.name:cmd.exe and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                       |
|Windows Misc LOLBin Connecting to the Internet        |                                       |                                | (process.name:expand.exe or process.name:extrac.exe or process.name:ieexec.exe or process.name:makecab.exe) and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16 |
|Windows Microsoft HTML Application (HTA) Connecting to the Internet              | Defense Evasion, Execution            | T1170 / Mshta                  | process.name:mshta.exe and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                     |
|Windows Powershell Connecting to the Internet          | Execution                             | T1086 / Powershell             | process.name:powershell.exe and event.action:"Network connection detected (rule: NetworkConnect)"  and not destination.ip:169.254.169.254/32 and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                |
|Windows HTML Help executable Program Connecting to the Internet          | Defense Evasion, Execution            | T1223 / Compiled HTML File     | process.name:hh.exe and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                        |
|Windows Register Server Program Connecting to the Internet           | Defense Evasion, Execution            | T1117 / Regsvr32               | (process.name:regsvr32.exe or process.name:regsvr64.exe) and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                                                   |
|Windows Script Interpreter Connecting to the Internet | Defense Evasion, Execution            | T1064 / Scripting               | (process.name:cscript.exe or process.name:wscript.exe) and event.action:"Network connection detected (rule: NetworkConnect)" and not destination.ip:10.0.0.0/8 and not destination.ip:172.16.0.0/12 and not destination.ip:192.168.0.0/16                                                      |
